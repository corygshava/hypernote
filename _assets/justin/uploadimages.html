<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Multi-Image Upload â€“ LuxeVault</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root{
            --primary:#1a1a1a;
            --gold:#d4af37;
            --gold-light:#f4e5a1;
            --light:#fafafa;
            --white:#ffffff;
            --gray:#666;
            --light-gray:#e5e5e5;
            --radius:12px;
            --shadow:0 2px 10px rgba(0,0,0,.08);
        }

        *{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}

        body{
            background:var(--light);
            display:flex;
            align-items:flex-start;
            justify-content:center;
            min-height:100vh;
            padding:40px 20px;
        }

        .upload-container{
            width:100%;
            max-width:640px;
            background:var(--white);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            padding:40px;
        }

        h2{
            font-weight:600;
            margin-bottom:25px;
            color:var(--primary);
            text-align:center;
        }

        .add-btn{
            background:var(--gold);
            color:var(--white);
            border:none;
            padding:10px 18px;
            border-radius:var(--radius);
            cursor:pointer;
            font-weight:600;
            margin-bottom:20px;
            transition:.3s;
        }

        .add-btn:hover{background:var(--primary)}

        .preview-grid{
            display:grid;
            grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
            gap:15px;
            margin-bottom:25px;
        }

        .preview-item{
            position:relative;
            border:1px solid var(--light-gray);
            border-radius:var(--radius);
            overflow:hidden;
            aspect-ratio:1/1;
            background:var(--light);
        }

        .preview-item img{
            width:100%;
            height:100%;
            object-fit:cover;
            display:block;
        }

        .remove-btn{
            position:absolute;
            top:5px;
            right:5px;
            background:var(--primary);
            color:var(--white);
            border:none;
            width:24px;
            height:24px;
            border-radius:50%;
            font-size:12px;
            cursor:pointer;
            opacity:.8;
            transition:.2s;
        }

        .remove-btn:hover{opacity:1;transform:scale(1.1)}
    </style>
</head>
<body>

<div class="upload-container">
    <h2>Upload Product Images</h2>

    <!-- hidden master input -->
    <input type="file" id="masterInput" accept="image/*" multiple style="display:none">

    <button class="add-btn" onclick="openFileDialog()">
        <i class="fas fa-plus"></i> Add Images
    </button>

    <!-- preview grid -->
    <div class="preview-grid" id="previewGrid"></div>
</div>

<script>
    const masterInput = document.getElementById('masterInput');
    const previewGrid = document.getElementById('previewGrid');
    const fileStore = new DataTransfer();   // keeps chosen files

    function openFileDialog() {
        masterInput.click();
    }

    masterInput.addEventListener('change', () => {
        for (const file of masterInput.files) {
            if (![...fileStore.files].some(f => f.name === file.name && f.size === file.size)) {
                fileStore.items.add(file);
                renderPreview(file);
            }
        }
        // reset input so the same file can be re-added if removed
        masterInput.value = '';
    });

    function renderPreview(file) {
        const item = document.createElement('div');
        item.className = 'preview-item';
        item.dataset.name = file.name;

        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);

        const removeBtn = document.createElement('button');
        removeBtn.className = 'remove-btn';
        removeBtn.innerHTML = '<i class="fas fa-times"></i>';
        removeBtn.onclick = () => removeImage(file.name, item);

        item.appendChild(img);
        item.appendChild(removeBtn);
        previewGrid.appendChild(item);
    }

    function removeImage(fileName, element) {
        // remove from DataTransfer
        const dt = new DataTransfer();
        for (const f of fileStore.files) {
            if (f.name !== fileName) dt.items.add(f);
        }
        fileStore.items.clear();
        for (const f of dt.files) fileStore.items.add(f);

        // remove preview
        element.remove();
    }

    /* expose chosen files for form submission:
       const filesToUpload = fileStore.files;
    */
</script>
</body>
</html>